<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>ADNOC GEOPORTAL</title>
    <link rel="stylesheet" href="css/app.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js"></script>
    <link rel="stylesheet" href="https://js.arcgis.com/4.12/esri/themes/dark/main.css">
    <style type="text/css">
        #container, #sliders {
            min-width: 310px;
            max-width: 800px;
            margin: 0 auto;
        }

        #container {
            height: 400px;
        }
    </style>
    <script src="js/jquery.js" type="text/javascript"></script>
    <script src="https://js.arcgis.com/4.12/"></script>
    <script src="js/app.js"></script>
    <script src="js/mapview3D.js"></script>
</head>
<body>
    <div id="wrapper">
        <div id="overall">
            <div class="banner">
                <table border=0>
                    <tr valign="top">
                        <td><img height="15%" style="padding-left:5px" src="images/ADNOC.png" /></td>
                        <td valign="middle"><h2 style="color:rgba(131,131,131,1);">Property Dashboard</h2></td>
                    </tr>
                </table>
            </div>

            <div id="sidebar_left1">
                <button class="accordion" id="legendbutton"><img height="30px" width="30px" style="padding-left:5px; vertical-align:middle" src="images/layers2.png" />&nbsp;&nbsp;&nbsp;<b>Layers</b></button>
                <div class="panel" id="legendlyrs"></div>
                <button class="accordion_search" id="searchbutton"><img height="30px" width="30px" style="padding-left:5px; vertical-align:middle" src="images/search.png" />&nbsp;&nbsp;&nbsp;<b>Searches</b></button>
                <div class="panel_search" id="serachpanel">
                </div>
            </div>
        </div>

        <div id="RightDiv">
            <div id="MapDiv"></div>


            <div id="queryDiv" class="esri-widget">
                <b>Query by geometry</b><br />
                <br />Draw a geometry to query by:
                <div class="geometry-options">
                    <button class="esri-widget--button esri-icon-map-pin geometry-button"
                            id="point-geometry-button"
                            value="point"
                            title="Query by point"></button>
                    <button class="esri-widget--button esri-icon-polyline geometry-button"
                            id="line-geometry-button"
                            value="polyline"
                            title="Query by line"></button>
                    <button class="esri-widget--button esri-icon-polygon geometry-button"
                            id="polygon-geometry-button"
                            value="polygon"
                            title="Query by polygon"></button>
                </div>
                <br />
                <div class="tooltip">
                    <label for="bufferNum">Set a geometry buffer size:</label>
                    <div id="bufferNum"></div>
                </div>
                <br />
                <button class="esri-button" id="clearGeometry" type="button">
                    Clear
                </button>
            </div>
            <div id="resultDiv" class="esri-widget">
                <div class="count">
                    Selected Buildings:
                    <div class="count" id="count">0</div>
                </div>
                <div class="charts">
                    <div>
                        <canvas id="year-chart" height="250" width="260" />
                    </div>
                    <div>
                        <canvas id="material-chart" width="250" height="300" />
                    </div>
                </div>
            </div>







            <div id="topbar">
                <button class="action-button esri-icon-minus" id="distanceButton" type="button"
                        title="Measure distance between two points"></button>
                <button class="action-button esri-icon-polygon" id="areaButton" type="button"
                        title="Measure area"></button>
            </div>
            <div id="homeDiv1"></div>








            <button class="accordionb" id="timeline1">Timeline</button>
            <div class="panelb" id="panelb">

                <div id="sliderContainer" class="esri-widget">
                    <span id="sliderValue"></span>
                    <div id="sliderInnerContainer">
                        <div id="sliderLabels">
                            <span>1978</span>
                            <span>2022</span>
                        </div>
                        <div id="rangeWrapper">
                            <input id="slider" type="range" min="1978" max="2022" step="1" value="1978" />
                        </div>
                    </div>
                    <div id="playButton" class="esri-widget esri-widget--button toggle-button">
                        <div>
                            <span class="toggle-button-icon esri-icon-play" aria-label="play icon"></span>
                            Play
                        </div>
                        <div>
                            <span class="toggle-button-icon esri-icon-pause" aria-label="pause icon"></span>
                            Pause
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
// legend layer outcome
var strHtml = ""; var groupname=[]; var subgroupname=[];
for (obj in legendlayers){ 
strHtml +="<button class='"+legendlayers[obj].legendlyrclass+"' id='"+legendlayers[obj].legendlyrid+"'>&nbsp;&nbsp;";
if(legendlayers[obj].legendsrc){strHtml +="<img height='20px' width='20px' style='padding-left:5px; vertical-align:middle' src='"+legendlayers[obj].legendsrc+"'/>";}
strHtml +="&nbsp;&nbsp;&nbsp;<b>"+legendlayers[obj].legendlayer+"</b></button>";
strHtml += "<div class='"+legendlayers[obj].legendlyrdivclass+"' id='"+legendlayers[obj].legendlyrdivid+"'>";
if(legendlayers[obj].sublegend){groupname=legendlayers[obj].sublegend;
for (ob in groupname){
strHtml += "<button class='"+groupname[ob].legendsubclass+"' id='"+groupname[ob].legendsubid+"'>&nbsp;&nbsp;&nbsp;<b>"+groupname[ob].sublegend+"</b></button>";
strHtml +="<div class='"+groupname[ob].legendsubdivclass+"' id='"+groupname[ob].legendsubdivid+"'>";
strHtml +="<table style='border-style:none;' cellspacing=0>";
subgroupname=groupname[ob].layering;
for (o in subgroupname){
strHtml +="<tr height=25><td width=15><input id='"+subgroupname[o].layerid+"' type='checkbox'";
if(subgroupname[o].checked){
strHtml +="checked";
} // end of check checking in table checkbox
strHtml +=" /></td><td width=215 style='color:rgba(131,131,131,1)'>&nbsp;&nbsp;&nbsp;"+subgroupname[o].layers+"</td></tr>";
} // end of loops for row repeat
strHtml +="</table></div>";
} // end of loop for sub legends
} // end of if statement
else {strHtml +="<table style='border-style:none;' cellspacing=0>";
subgroupname=legendlayers[obj].layering;
for (o in subgroupname){
strHtml +="<tr height=25><td width=15><input id='"+subgroupname[o].layerid+"' type='checkbox'";
if(subgroupname[o].checked){strHtml +="checked";}
strHtml +=" /></td><td width=215 style='color:rgba(131,131,131,1)'>&nbsp;&nbsp;&nbsp;"+subgroupname[o].layers+"</td></tr>";
} // end of loop for table row repat
strHtml +="</table></div>";
} //end of else statement without legend
strHtml +="</div>";} // end of main for loop
document.getElementById("legendlyrs").innerHTML = strHtml;
// search layer outcome
var srhHtml=""; var searchgroup=[]; var optgroup=[];
for (obj in searchlayers){ 
srhHtml +="<button id='"+searchlayers[obj].buttonid+"' class='"+searchlayers[obj].buttonclass+"'>&nbsp;&nbsp;&nbsp;<b>"+searchlayers[obj].buttonname+"</b></button>";
srhHtml +="<div class='"+searchlayers[obj].buttondivclass+"' id='"+searchlayers[obj].buttondivid+"'>";
searchgroup=searchlayers[obj].searchopts;
for (ob in searchgroup){
    srhHtml += "<div class='" + searchgroup[ob].optdivclass + "' id='" + searchgroup[ob].optdivid + "'>";
srhHtml +="<div class='"+searchgroup[ob].namedivclass+"'>"+searchgroup[ob].namediv+":</div>";
srhHtml +="<div class='select'><select id='"+searchgroup[ob].selectid+"' class='select-list'>";
optgroup=searchgroup[ob].optionsselect;
if(optgroup){
for (o in optgroup){
    srhHtml += "<option value='" + optgroup[o].optionval + "'>" + optgroup[o].optionvalue + "</option>";
} // end of options for loop
} // end of if statement to check options
srhHtml += "</select></div></div><div id='" + searchgroup[ob].spacedivid + "'><br /></div>";
} // end of search tags
srhHtml += "<div class='" + searchlayers[obj].resultdivclass + "' id='" + searchlayers[obj].resultdivid + "'><div class='" + searchlayers[obj].finalrseltclass + "'>";
srhHtml += "<span id='" + searchlayers[obj].finalresultid + "'></span></div></div><div id='" + searchlayers[obj].spacedivid + "'></div></div>";
} // end of main search                              
document.getElementById("serachpanel").innerHTML = srhHtml;
                                
for (obj in searchlayers) { searchgroup = searchlayers[obj].searchopts;
    for (ob in searchgroup) {if (ob >= 1) {$('#' + searchgroup[ob].optdivid).hide(); $('#' + searchgroup[ob].spacedivid).hide();}}
    $('#' + searchlayers[obj].resultdivid).hide();}

var objy="";
var obji="";
var tleng=0;
for (obj in searchlayers) {searchgroup = searchlayers[obj].searchopts;
    for (ob in searchgroup) {$('#' + searchgroup[ob].selectid).change(function () {
        for (obj in searchlayers) { searchgroup = searchlayers[obj].searchopts;
            for (ob in searchgroup) { var leng = searchgroup.length - 1;
            if (this.id == searchgroup[ob].selectid) {  if (leng == ob) { $('#' + searchlayers[obj].resultdivid).show();
                        for (var i = 0; i < ob; i++) { $('#' + searchgroup[i + 1].optdivid).show();  $('#' + searchgroup[i + 1].spacedivid).show();}
                        } else if (objy>ob&obji==obj){ objy=0; tleng=leng-ob;
				for (var i = 0; i <= tleng-2; i++) { if(searchgroup[i + 2].optdivid){ $('#' + searchgroup[i + 2].optdivid).hide(); $('#' + searchgroup[i + 2].spacedivid).hide();}
                            }} else { $('#' + searchlayers[obj].resultdivid).show();
                 for (var i = 0; i <= ob; i++) {$('#' + searchgroup[i + 1].optdivid).show(); $('#' + searchgroup[i + 1].spacedivid).show(); }
objy=ob; obji=obj;
} }}}});
    }
}

var tmaindiv = [], groupname = [], layergroup=[], layersubgroup=[], tcbuttons = [], tcpaneldiv=[], tcpanelid=[], tcpanelsubdiv=[], buttonsumname = [], butspan = [], butdiv = [], tlayers=[],tcexception=[];
var todds = [];
for (obj in legendlayers) {
    if (legendlayers[obj].layering) {
        tcbuttons.push(legendlayers[obj].legendlyrclass);
        var layergroup=legendlayers[obj].layering ;    
        for (o in layergroup) { tcpanelid.push(layergroup[o]); tcpaneldiv.push(legendlayers[obj].legendlyrdivclass); tcpanelsubdiv.push(legendlayers[obj].legendlyrdivclass); tmaindiv.push(buttonlayers[0].buttondivclass); if (legendlayers[obj].exception) { tcexception.push(legendlayers[obj].exception); } else { tcexception.push(0); }}
    }
    if (legendlayers[obj].sublegend) {
        tcbuttons.push(legendlayers[obj].legendlyrclass);
        groupname = legendlayers[obj].sublegend;
        for (obs in groupname) {tcbuttons.push(groupname[obs].legendsubclass); layersubgroup = groupname[obs].layering;
        for (o in layersubgroup) {tcpanelid.push(layersubgroup[o]); tcpaneldiv.push(legendlayers[obj].legendlyrdivclass); tcpanelsubdiv.push(groupname[obs].legendsubdivclass); tmaindiv.push(buttonlayers[0].buttondivclass);if (groupname[obs].exception) { tcexception.push(groupname[obs].exception); } else { tcexception.push(0);}} }
    }
}
for (obj in searchlayers) { tcbuttons.push(searchlayers[obj].buttonclass); tcpanelid.push(searchlayers[obj]); tcpaneldiv.push(searchlayers[obj].buttondivclass); tcpanelsubdiv.push(searchlayers[obj].buttondivclass); tmaindiv.push(buttonlayers[1].buttondivclass); if (searchlayers[obj].exception) { tcexception.push(searchlayers[obj].exception); } else { tcexception.push(0); }  }
for (obj in buttonlayers) { tcbuttons.push(buttonlayers[obj].buttonclass); tcpanelid.push(buttonlayers[obj]); tcpaneldiv.push(buttonlayers[obj].buttondivclass); tcpanelsubdiv.push(buttonlayers[obj].buttondivclass); tmaindiv.push(buttonlayers[obj].buttondivclass); if (buttonlayers[obj].exception) { tcexception.push(buttonlayers[obj].exception); } else { tcexception.push(0); }}
for (obj in tcbuttons) {butdiv[obj] = document.getElementsByClassName(tcbuttons[obj]); buttonsumname = butdiv[obj];
 for (var i = 0; i < buttonsumname.length; i++) { try{throw i} catch(ii) {
            buttonsumname[ii].addEventListener("click", function () {
                this.classList.toggle("active");
                butspan[ii] = this.nextElementSibling;
                if (butspan[ii].style.display === "block") { butspan[ii].style.display = "none";
                    for (o in tcpanelid) {
                        if (tcpanelid[o].layerid) {
                            if (tcpanelid[o].checked === "yes") { $('#' + tcpanelid[o].layerid).prop("checked", true).attr("disabled", false); } else { $('#' + tcpanelid[o].layerid).prop("checked", false).attr("disabled", false); }
                        }
                    }
                } else {
                    butspan[ii].style.display = "block";
                    var tevens = [];
                    var ttcpanel1 = []; var ttcpanel2 = []; var ttccpanel1 = []; var ttccpanel2 = []; var ttcpanel = []; var ttcpanelo = [];
                    for (o in tcpaneldiv) {
                        if (butspan[ii].classList[0] === tmaindiv[o]) { tevens.push(o); ttcpanel1.push(tmaindiv[o]);   if (tcexception[o] !== 0) {  for (j in tcpanelid) { if (tcexception[o].includes(tcpanelid[j].layerid)) { tevens.push(j); ttcpanel1.push(tmaindiv[j]);   ttcpanel1.push(tcpaneldiv[j]); ttcpanel1.push(tcpanelsubdiv[j]);} } }}
                        else if (butspan[ii].classList[0] !== tmaindiv[o] && butspan[ii].classList[0] === tcpaneldiv[o]) { tevens.push(o); ttcpanel1.push(tcpaneldiv[o]); ttcpanel1.push(tmaindiv[o]); if (tcexception[o] !== 0) { for (j in tcpanelid) { if (tcexception[o].includes(tcpanelid[j].layerid)) { tevens.push(j); ttcpanel1.push(tmaindiv[j]);   ttcpanel1.push(tcpaneldiv[j]); ttcpanel1.push(tcpanelsubdiv[j]);} } } }
                        else if (butspan[ii].classList[0] !== tmaindiv[o] && butspan[ii].classList[0] !== tcpaneldiv[o] && butspan[ii].classList[0] === tcpanelsubdiv[o]) { tevens.push(o); ttcpanel1.push(tcpaneldiv[o]); ttcpanel1.push(tcpanelsubdiv[o]); ttcpanel1.push(tmaindiv[o]); if (tcexception[o] !== 0) { for (j in tcpanelid) { if (tcexception[o].includes(tcpanelid[j].layerid)) { tevens.push(j); ttcpanel1.push(tcpaneldiv[j]); ttcpanel1.push(tcpanelsubdiv[j]); ttcpanel1.push(tmaindiv[j]);} } } }
                    }
                    for (o in tcpaneldiv) {
                        ttcpanel2.push(tcpaneldiv[o]); ttcpanel2.push(tcpanelsubdiv[o]); ttcpanel2.push(tmaindiv[o]);
                        if (tevens.includes(o)) { if (tcpanelid[o].checked === "yes") { $('#' + tcpanelid[o].layerid).prop("checked", true).attr("disabled", false); } else { $('#' + tcpanelid[o].layerid).prop("checked", false).attr("disabled", false); }
                        } else { if (tcpanelid[o].layerid) {  $('#' + tcpanelid[o].layerid).prop("checked", false).attr("disabled", true);}}
                    }
                     ttccpanel1 = ttcpanel1.filter(function (item, pos) {return ttcpanel1.indexOf(item) == pos; })
                     ttccpanel2 = ttcpanel2.filter(function (item, pos) { return ttcpanel2.indexOf(item) == pos;})
                     ttcpanel = ttccpanel2.filter(function (x) { return ttccpanel1.indexOf(x) < 0; });
                     for (k in ttcpanel) { 
                         $('.' + ttcpanel[k]).removeAttr("style").hide();
                     }
for (k in ttcpanel1) { 
                         $('.' + ttcpanel1[k]).show();
                     }
                }
            });
            }}}
 </script>
</body></html>